
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Nexus6 MCP UI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 24px; }
    button { padding: 8px 12px; margin: 4px; border-radius: 10px; border: 1px solid #ccc; }
    #log { white-space: pre-wrap; border: 1px solid #ddd; padding: 12px; border-radius: 8px; max-height: 300px; overflow: auto; }
    input, textarea { width: 100%; max-width: 700px; margin: 6px 0; padding: 8px; }
    .row { margin: 12px 0; }
  </style>
</head>
<body>
  <h1>Nexus6 — Push/Pull + Hash + Log + A2A</h1>

  <div class="row">
    <h3>STATE_LOG</h3>
    <input id="logLine" placeholder="One-line entry" />
    <button onclick="appendLog()">Append</button>
  </div>

  <div class="row">
    <h3>SHA-256</h3>
    <textarea id="hashText" rows="4" placeholder="Enter text to hash"></textarea>
    <button onclick="hashText()">Compute</button>
    <div id="hashOut"></div>
  </div>

  <div class="row">
    <h3>A2A Live Feed</h3>
    <button onclick="connectFeed()">Connect Live Feed</button>
    <div id="log"></div>
  </div>

<script>
async function appendLog(){
  const line = document.getElementById('logLine').value;
  const r = await fetch('/api/log', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({agent:'Axlon', message: line})});
  alert('Logged: ' + (await r.text()));
}
async function hashText(){
  const text = document.getElementById('hashText').value;
  const r = await fetch('/api/hash', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({text})});
  document.getElementById('hashOut').textContent = await r.text();
}
function connectFeed(){
  const ev = new EventSource('/api/a2a/feed');
  const log = document.getElementById('log');
  ev.onmessage = (m)=>{
    const d = JSON.parse(m.data);
    log.textContent += `\n[${new Date(d.ts).toLocaleTimeString()}] ${d.from} → ${d.to}: ${d.body}`;
  };
}
</script>
</body>
</html>
